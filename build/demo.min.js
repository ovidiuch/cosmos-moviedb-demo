Cosmos.components.MovieCredits=React.createClass({mixins:[Cosmos.mixins.ClassName,Cosmos.mixins.PersistState],defaultClass:"movie-credits",render:function(){var t=this.getCrewFromDepartment("Directing"),e=this.getCrewFromDepartment("Writing"),s=this.getActors();return React.DOM.ul({className:"movie-credits"},React.DOM.li({className:"directors"},this.getItemPrefix("Director",t.length),": ",React.DOM.strong(null,t.join(", "))),React.DOM.li({className:"writers"},this.getItemPrefix("Writer",e.length),": ",React.DOM.strong(null,e.join(", "))),React.DOM.li({className:"actors"},this.getItemPrefix("Actor",s.length),": ",React.DOM.strong(null,s.join(", "))))},getCrewFromDepartment:function(t){var e=_.filter(this.props.crew,function(e){return e.department==t});return _.map(e,function(t){return t.name})},getActors:function(){return _.map(this.props.cast.slice(0,4),function(t){return t.name})},getItemPrefix:function(t,e){return e>1?t+"s":t}}),Cosmos.components.MovieThumbnail=React.createClass({mixins:[Cosmos.mixins.ClassName,Cosmos.mixins.PersistState,Cosmos.mixins.Url],defaultClass:"movie-thumbnail",render:function(){return React.DOM.a({className:this.getClassName(),href:this.getUrlFromProps(this.getPropsForMovie()),onClick:this.routeLink,style:{backgroundImage:"url("+this.getUrlForPosterImage()+")"}})},getPropsForMovie:function(){return{component:"Movie",posterPath:this.props.poster_path,dataUrl:App.MOVIEDB_API_ROOT+"/movie/"+this.props.id+"?append_to_response=credits,similar_movies&api_key="+App.MOVIEDB_API_KEY}},getUrlForPosterImage:function(){return App.MOVIEDB_IMG_ROOT+"/w154"+this.props.poster_path}}),Cosmos.components.Movie=React.createClass({mixins:[Cosmos.mixins.ClassName,Cosmos.mixins.DataFetch,Cosmos.mixins.PersistState],defaultClass:"movie full-background",render:function(){var t=this.getBackgroundStyle();return React.DOM.div({className:this.getClassName(),style:t},React.DOM.div({className:"full-background-content"},this.getContentDOM()))},getContentDOM:function(){return _.isEmpty(this.state.data)?null:React.DOM.div({className:"content-wrapper"},React.DOM.h1({className:"movie-title"},this.state.data.title+" ",React.DOM.span({className:"year"},"(",this.getReleaseYear(),")")),Cosmos({component:"MovieCredits",cast:this.state.data.credits.cast,crew:this.state.data.credits.crew}),React.DOM.p({className:"movie-plot"},this.state.data.overview),React.DOM.p({className:"similar-to"},"similar to..."),Cosmos({component:"List",itemComponent:"MovieThumbnail","class":"movie-list",state:{data:this.getSimilarMovies()}}))},getBackgroundStyle:function(){return this.getPosterPath()?{backgroundImage:"url("+this.getUrlForBackgroundImage(780)+"),url("+this.getUrlForBackgroundImage(154)+")"}:{}},getReleaseYear:function(){return new Date(this.state.data.release_date).getFullYear()},getSimilarMovies:function(){var t=this.state.data.similar_movies.results||[];return t=_.filter(t,function(t){return!!t.poster_path}),t=_.sortBy(t,function(t){var e=t.vote_count>5?t.vote_average:0;return-e})},getUrlForBackgroundImage:function(t){return App.MOVIEDB_IMG_ROOT+"/w"+t+this.getPosterPath()},getPosterPath:function(){return this.props.posterPath||this.state.data.poster_path}});